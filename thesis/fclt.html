<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Functional Central Limit Theorem</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <!-- MathJax -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    /* Styling for math equations */
    .math {
      display: block;
      text-align: center;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="mt-4 mb-4">Functional Central Limit Theorem</h1>

    <div class="row">
      <div class="col-md-8">
        <p>
            The <em>Functional Central Limit Theorem</em> is a functional extension of the <a href="https://zionick1.github.io/nickstatistics.github.io/thesis/clt.html">central limit theorem </a> for empirical distribution functions. The theorem states that an empirical distribution function that is appropriately centered and scaled converges to a gaussian process
        </p>

        <p>Mathematically, the FCLT can be represented as:</p>
        <p class="math">\( \sqrt{n}(X_n - \mu) \xrightarrow{d} N(0, \sigma^2) \)</p>

        <p>Here, \( X_n \) represents the sum of independent random functions, \( \mu \) is the mean, \( \sigma^2 \) is the variance, and \( \xrightarrow{d} \) denotes convergence in distribution as \( n \), the number of functions, grows.</p>

        <p>The theorem has applications in various fields such as statistics, econometrics, and signal processing, providing insights into the behavior of complex systems composed of many random elements.</p>
        <p class="h4">
          Formal statement
        </p>
        <p class="math">
          Let \(F_n\) be the empirical distribution of i.i.d. random variables with distribution function <i>F</i>. Define the centered and scaled \(F_n\) by 
          \[
          G_n(x) = \sqrt{n}(F_n(n)-F(x))
          \]
          With n increasing, it converges to a gaussian distribution by the central limit theorem, for fixed x.
        </p>
        <p class="h4">
            Proof sketch
        </p>
        <p class="math">
            A rigorous proof of this theorem involves advanced mathematichs tools. It all starts with:
            let \(\mathbf{X_n}\) be a sequence of identically distributed random variables \(X_i\) with mean 0 and variance 1.
            The sample mean defined as: 
            \[
                \overline{X} = \frac{1}{n} \sum_{i=1}^{n} X_i
            \]
            with n becoming more and more large, the distribution \(\overline{X}\) converges to a normal distribution with a mean \(\mu\) and variance \(\frac{\sigma^2}{n}\).
            This is a simple consequence due to the law of large numbers: the average of a large number of independet and identically distributed random variables tends to be close to the expected value.
        </p>
      </div>
      <p class="h4">
        Simulation
      </p>
      <p>
        Below a python code snippet that simulates the above theorem:
      </p>
      <pre>
        <code>
import numpy as np
import matplotlib.pyplot as plt

def random_function(x):
    # Define your random function here
    return np.sin(x) + np.random.normal(0, 0.1, size=len(x))

def simulate_fclt(num_functions, sample_size):
    # Generate independent random functions and sum them up
    functions = [random_function(np.linspace(0, 1, sample_size)) for _ in range(num_functions)]
    sum_function = np.sum(functions, axis=0)

    # Plot the individual functions and their sum
    plt.figure(figsize=(10, 6))
    for i in range(num_functions):
        plt.plot(np.linspace(0, 1, sample_size), functions[i], alpha=0.5, label=f'Function {i+1}')
    plt.plot(np.linspace(0, 1, sample_size), sum_function, color='black', linewidth=2, label='Sum of Functions')
    
    plt.title('Functional Central Limit Theorem Simulation')
    plt.xlabel('X')
    plt.ylabel('Y')
    plt.legend()
    plt.show()

# Set the number of functions and sample size
num_functions = 10
sample_size = 1000

# Simulate FCLT
simulate_fclt(num_functions, sample_size)

        </code>
      </pre>
      <p>
        <img src="./images/fclt.png" alt="fclt simulations">
      </p> 
      <ul>
        <li>
          <a href="https://en.wikipedia.org/wiki/Donsker%27s_theorem">1</a>
        </li>
      </ul>  
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
